<!-- Advanced Users UI Redesign (Bootstrap 5) -->
<div class="container py-4">
  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="fw-bold m-0">Users</h3>
    <button class="btn btn-primary px-4" (click)="openNew()">Create New</button>
  </div>

  <!-- Search + Filters Box -->
  <div class="card shadow-sm border-0 p-3 mb-4 rounded-4 bg-light">
    <div class="row g-3">
      <div class="col-md-4">
        <input
          type="text"
          [(ngModel)]="searchTerm"
          (input)="onSearchChange()"
          class="form-control"
          placeholder="Search user..."
        />
      </div>
      <div class="col-md-3">
        <select
          class="form-select"
          [(ngModel)]="sortOrder"
          (change)="onSortChange()"
        >
          <option value="asc">Sort A–Z</option>
          <option value="desc">Sort Z–A</option>
        </select>
      </div>
      <div class="col-md-3">
        <select
          class="form-select"
          [(ngModel)]="selectStatus"
          (change)="onsortStatusChange()"
        >
          <option value="">All</option>
          <option value="all">All</option>
          <option value="active">Active</option>
          <option value="inactive">Inactive</option>
        </select>
      </div>
      <div class="col-md-2">
        <button class="btn btn-primary w-100">Search</button>
      </div>
    </div>
  </div>

  <!-- Form -->
  <div *ngIf="form" class="card shadow-sm p-4 rounded-4 mb-4 border-0">
    <h5 class="fw-bold mb-3">{{ form.id ? 'Edit' : 'New' }} User</h5>
    <form (submit)="addUser($event)">
      <div class="row g-3">
        <div class="col-md-4">
          <input
            type="text"
            class="form-control"
            placeholder="Name"
            [(ngModel)]="form.username"
            name="username"
          />
        </div>
        <div class="col-md-4">
          <input
            type="email"
            class="form-control"
            placeholder="Email"
            [(ngModel)]="form.email"
            name="email"
          />
        </div>
        <div class="col-md-4">
          <input
            type="password"
            class="form-control"
            placeholder="Password"
            [(ngModel)]="form.password"
            name="password"
          />
        </div>
        <div class="col-md-4">
          <input
            type="text"
            class="form-control"
            placeholder="Status"
            [(ngModel)]="form.status"
            name="status"
          />
        </div>
      </div>

      <div class="d-flex justify-content-end gap-2 mt-4">
        <button
          type="button"
          class="btn btn-outline-secondary px-4"
          (click)="cancel()"
        >
          Cancel
        </button>
        <button type="submit" class="btn btn-success px-4">Save</button>
      </div>
    </form>
  </div>

  <!-- Table Card -->
  <div class="card shadow-sm border-0 rounded-4 p-3">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h5 class="fw-bold m-0">User List</h5>
      <select class="form-select w-auto">
        <option>Show 10</option>
        <option>Show 20</option>
        <option>Show 50</option>
      </select>
    </div>

    <div class="table-responsive">
      <table class="table table-hover align-middle customTable">
        <thead class="table-light">
          <tr>
            <th>#</th>
            <th>Username</th>
            <th>Email</th>
            <th>Status</th>
            <th class="text-center">Actions</th>
          </tr>
        </thead>
        @defer { @if(usersList.length !== 0){
        <tbody>
          @for (order of usersList; track $index) {
          <tr
            [class.active]="order.status === 'active'"
            [class.inactive]="order.status === 'inactive'"
          >
            <td><strong>{{ $index + 1 }}</strong></td>
            <td>{{ order.username }}</td>
            <td>{{ order.email }}</td>
            <td>
              <span
                class="badge bg-{{ order.status === 'active' ? 'success' : 'danger' }}"
              >
                {{ order.status }}
              </span>
            </td>
            <td class="text-center">
              <button
                class="btn btn-sm btn-outline-primary me-2"
                (click)="editUser(order)"
              >
                Edit
              </button>
              <button
                class="btn btn-sm btn-outline-danger"
                (click)="deleteUser(order._id)"
              >
                Delete
              </button>
            </td>
          </tr>
          }
        </tbody>
        } }@placeholder{
        <tbody>
          <tr>
            <td colspan="4" class="text-center">Loading Users...</td>
          </tr>
        </tbody>
        }
      </table>
    </div>
  </div>
</div>
